<!DOCTYPE html>
<html lang="en-US"> 
<head>
  <meta charset="UTF-8" />
  <title>The SE Pax8 Game</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      background: #f4f4f4;
    }
    #playerForm {
      margin-top: 20px;
      padding: 10px;
    }
    #hud {
      display: none;
      align-items: center;
      gap: 12px;
      background: #333;
      color: white;
      padding: 10px;
      width: 100%;
      max-width: 1000px;
      box-sizing: border-box;
      flex-wrap: wrap;
    }
    #hud .group {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    #hud button, #hud select {
      background: #4CAF50;
      color: white;
      border: none;
      padding: 6px 10px;
      cursor: pointer;
      border-radius: 6px;
    }
    #hud select {
      background: #555;
    }
    #hud button:disabled {
      background: #666;
      cursor: not-allowed;
    }
    #gameArea {
      width: 100%;
      max-width: 1000px;
      height: 560px;
      background: white;
      border: 2px solid #333;
      position: relative;
      overflow: hidden;
    }
    /* Cada alvo - s√≥ a logo vis√≠vel */
/* Container do alvo - totalmente transparente e sem tamanho fixo */
.target {
  position: absolute;
  cursor: pointer;
  display: inline-flex; /* s√≥ envolve o tamanho do conte√∫do */
  justify-content: center;
  align-items: center;
  background: none !important; /* garante que n√£o tenha fundo */
  border: none !important;     /* garante que n√£o tenha borda */
  padding: 0;
  margin: 0;
  box-sizing: border-box;
  user-select: none;
}

/* Logo define o tamanho final e leva a borda */
.target img {
  display: block;           /* remove espa√ßamento fantasma de img inline */
  width: 110px;             /* ajuste conforme quiser */
  height: 110px;
  object-fit: contain;
  border: 2px solid #000;   /* borda preta apenas na imagem */
  border-radius: 8px;       /* opcional: cantos arredondados */
  background: white;        /* opcional: fundo branco atr√°s da logo */
  pointer-events: none;     /* clique passa para o container */
  user-select: none;
}
    /* Time bar */
    .timebar-wrap {
      flex: 1;
      height: 10px;
      background: #555;
      border-radius: 6px;
      overflow: hidden;
      min-width: 200px;
    }
    #timeBar {
      height: 100%;
      width: 100%;
      background: #4CAF50;
      transition: width 0.25s linear;
    }
    /* Leaderboard modal */
    #modalOverlay {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.6);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 999;
      padding: 16px;
      box-sizing: border-box;
    }
    #modalContent {
      background: white;
      padding: 20px;
      border-radius: 12px;
      width: 380px;
      max-height: 70vh;
      overflow-y: auto;
      text-align: center;
      box-shadow: 0 10px 30px rgba(0,0,0,0.35);
      animation: pop 0.25s ease-out;
    }
    #modalContent h3 { margin-top: 0; }
    @keyframes pop {
      from { transform: scale(0.9); opacity: 0; }
      to   { transform: scale(1);   opacity: 1; }
    }
    .modal-actions {
      display: flex;
      gap: 8px;
      justify-content: center;
      margin-top: 12px;
    }
    .btn {
      background: #333;
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
    }
    .btn.primary { background: #4CAF50; }
    /* Highlight current player */
    .highlight {
      color: #e63946;       /* red */
      font-weight: bold;
    }
    .highlight::after {
      content: " (you)";
      font-size: 0.9em;
      font-style: italic;
      margin-left: 4px;
    }
    /* Persistent Leaderboard */
    #ranking {
      margin-top: 20px;
      background: #fff;
      border: 2px solid #333;
      padding: 10px;
      width: 100%;
      max-width: 1000px;
      box-sizing: border-box;
    }
    /* Tiny badge for combo */
    #comboBadge {
      background: #222;
      border: 1px solid #666;
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 12px;
    }
    /* Mute indicator */
    #muteBtn.muted { background: #888 !important; }

    /* Intro / Instructions modal */
    #introOverlay {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.6);
      display: none;              /* shown via JS */
      justify-content: center;
      align-items: center;
      z-index: 1000;
      padding: 16px;
      box-sizing: border-box;
    }
    #introContent {
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      width: 520px;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 10px 30px rgba(0,0,0,0.35);
      animation: pop 0.25s ease-out;
    }
    #introContent h2 { margin: 0 0 8px; }
    #introContent ul { margin: 10px 0 0 18px; }
    #introContent li { margin: 6px 0; }
    #introActions {
      display: flex;
      gap: 10px;
      justify-content: space-between;
      align-items: center;
      margin-top: 14px;
    }
    #introStartBtn {
      background: #4CAF50;
      color: #fff;
      border: none;
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <!-- Intro / Instructions -->
  <div id="introOverlay">
    <div id="introContent">
      <h2>How to Play</h2>
      <p>
        The goal is to learn, in a playful way, which vendors the TPS team
        <strong>supports with demos and onboarding</strong> (vendor supported) and which ones are not covered.
      </p>

      <h3>Objective</h3>
      <ul>
        <li>Click the product tiles that are <strong>demo/onboarding supported</strong>.</li>
        <li>Avoid clicking products that are <strong>not</strong> supported.</li>
      </ul>

      <h3>Scoring</h3>
      <ul>
        <li><strong>+10 pts</strong> for a supported vendor (correct click).</li>
        <li><strong>-5 pts</strong> for a non-supported vendor (wrong click).</li>
        <li><strong>-1 pt</strong> for clicking empty space (miss).</li>
      </ul>

      <h3>Combo / Streak</h3>
      <ul>
        <li>Every 5 consecutive correct hits increases a <strong>combo</strong> (+25% per step).</li>
        <li>Missing or a wrong click resets the streak.</li>
      </ul>

      <h3>Difficulty</h3>
      <ul>
        <li><strong>Easy</strong>: more time, slower spawn, targets stay longer.</li>
        <li><strong>Normal</strong>: default settings.</li>
        <li><strong>Hard</strong>: less time, faster spawn, shorter target life, and a <strong>1.5√ó score multiplier</strong> on correct hits.</li>
      </ul>

      <h3>Timer & Sounds</h3>
      <ul>
        <li>The green bar shows time remaining.</li>
        <li>Toggle sound with the <strong>üîä button</strong> or press <strong>M</strong>.</li>
      </ul>

      <h3>Leaderboard</h3>
      <ul>
        <li>Scores are saved locally (this browser) and shown after each round.</li>
        <li>The last player is highlighted in red with ‚Äú(you)‚Äù.</li>
      </ul>

      <div id="introActions">
        <label><input type="checkbox" id="introDontShow"> Don‚Äôt show this again</label>
        <button id="introStartBtn">Got it ‚Äî let‚Äôs play</button>
      </div>
    </div>
  </div>

  <!-- Player form -->
  <div id="playerForm">
    <label>Your Name:</label>
    <input type="text" id="playerName" placeholder="Type your name" />
    <button id="saveNameBtn">OK</button>
  </div>

  <!-- HUD -->
  <div id="hud">
    <div class="group"><strong>Points:</strong> <span id="score">0</span></div>
    <div class="group"><strong>Time:</strong> <span id="time">45</span>s</div>
    <div class="timebar-wrap"><div id="timeBar"></div></div>
    <div class="group">
      <label for="difficulty"><strong>Difficulty:</strong></label>
      <select id="difficulty">
        <option value="easy">Easy</option>
        <option value="normal" selected>Normal</option>
        <option value="hard">Hard</option>
      </select>
    </div>
    <div class="group"><span id="comboBadge">Streak: 0 | Combo: x1.00</span></div>
    <div class="group">
      <button id="muteBtn" title="Toggle sound (M)">üîä Sound</button>
      <button id="startBtn">Start Game</button>
    </div>
  </div>

  <!-- Game area -->
  <div id="gameArea"></div>

  <!-- Audio -->
  <audio id="sndHit"  src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_c7c2b1.mp3?filename=click-124467.mp3"></audio>
  <audio id="sndMiss" src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_6db2aa.mp3?filename=error-126627.mp3"></audio>

  <!-- Modal (Leaderboard) -->
  <div id="modalOverlay">
    <div id="modalContent">
      <h3>üèÜ Leaderboard üèÜ</h3>
      <ol id="rankingList"></ol>
      <div class="modal-actions">
        <button id="playAgainBtn" class="btn primary">Play again</button>
        <button id="closeModal" class="btn">Close</button>
      </div>
    </div>
  </div>

  <!-- Persistent Leaderboard -->
  <div id="ranking">
    <h3>üèÜ Hall of Fame üèÜ</h3>
    <ol id="rankingListPersist"></ol>
  </div>

  <script>
    // === Products (full list) ===
    const rawProducts = [
  { name: "Zero Networks", demo: false, logo: "images/zero.jpg" },
  { name: "Webroot", demo: false, logo: "images/webroot.jpg" },
  { name: "VirtlX", demo: false, logo: "images/virtlx.jpg" },
  { name: "Vicarius", demo: false, logo: "images/vicarius.jpg" },
  { name: "Usecure", demo: false, logo: "images/usecure.jpg" },
  { name: "TruGrid", demo: false, logo: "images/trugrid.jpg" },
  { name: "TrendMicro", demo: false, logo: "images/trendmicro.jpg" },
  { name: "Sectigo", demo: false, logo: "images/sectigo.jpg" },
  { name: "Rewst", demo: false, logo: "images/rewst.jpg" },
  { name: "Revscale", demo: false, logo: "images/revscale.jpg" },
  { name: "Red Sift", demo: false, logo: "images/redsift.jpg" },
  { name: "Probax", demo: false, logo: "images/probax.jpg" },
  { name: "Pillr", demo: false, logo: "images/pillr.jpg" },
  { name: "Perception Point", demo: false, logo: "images/perceptionpoint.jpg" },
  { name: "Netwrix", demo: false, logo: "images/netwrix.jpg" },
  { name: "Nerdio", demo: false, logo: "images/nerdio.jpg" },
  { name: "N-Able", demo: false, logo: "images/nable.jpg" },
  { name: "MSPFCO", demo: false, logo: "images/mspfco.jpg" },
  { name: "MSPbots", demo: false, logo: "images/mspbots.jpg" },
  { name: "Mailguard365", demo: false, logo: "images/mailguard365.jpg" },
  { name: "Liongard", demo: false, logo: "images/liongard.jpg" },
  { name: "Kalibr8", demo: false, logo: "images/kalibr8.jpg" },
  { name: "ITagree", demo: false, logo: "images/itagree.jpg" },
  { name: "Hacware", demo: false, logo: "images/hacware.jpg" },
  { name: "Guardz", demo: false, logo: "images/guardz.jpg" },
  { name: "GoTo", demo: false, logo: "images/goto.jpg" },
  { name: "Foxit", demo: false, logo: "images/foxit.jpg" },
  { name: "Exium", demo: false, logo: "images/exium.jpg" },
  { name: "Egnyte", demo: false, logo: "images/egnyte.jpg" },
  { name: "EasyDMARC", demo: false, logo: "images/easydmarc.jpg" },
  { name: "Devicie", demo: false, logo: "images/devicie.jpg" },
  { name: "DefenseX", demo: false, logo: "images/defensex.jpg" },
  { name: "Cyrisma", demo: false, logo: "images/cyrisma.jpg" },
  { name: "CyberQP", demo: false, logo: "images/cyberqp.jpg" },
  { name: "Cyber Fox", demo: false, logo: "images/cyberfox.jpg" },
  { name: "Connectwise", demo: false, logo: "images/connectwise.jpg" },
  { name: "Commvault", demo: false, logo: "images/commvault.jpg" },
  { name: "CloudRadial", demo: false, logo: "images/cloudradial.jpg" },
  { name: "Call2Teams", demo: false, logo: "images/call2teams.jpg" },
  { name: "Bvoip", demo: false, logo: "images/bvoip.jpg" },
  { name: "BreachSecureNow", demo: false, logo: "images/breachsecurenow.jpg" },
  { name: "BitTitan", demo: false, logo: "images/bittitan.jpg" },
  { name: "Airslate", demo: false, logo: "images/airslate.jpg" },
  { name: "Actifile", demo: false, logo: "images/actifile.jpg" },
  { name: "1Password", demo: false, logo: "images/1password.jpg" },
  { name: "Traceless", demo: false, logo: "images/traceless.jpg" },
  { name: "Solgari", demo: false, logo: "images/solgari.jpg" },
  { name: "Salesbuildr", demo: false, logo: "images/salesbuildr.jpg" },
  { name: "Officeatwork", demo: false, logo: "images/officeatwork.jpg" },
  { name: "MontyCloud", demo: false, logo: "images/montycloud.jpg" },
  { name: "CyberCert", demo: false, logo: "images/cybercert.jpg" },
  { name: "Cloud Contracts 365", demo: false, logo: "images/cloudcontracts365.jpg" },

  // YES
  { name: "Watchguard", demo: true, logo: "images/watchguard.jpg" },
  { name: "Wasabi", demo: true, logo: "images/wasabi.jpg" },
  { name: "Valimail", demo: true, logo: "images/valimail.jpg" },
  { name: "Vade", demo: true, logo: "images/vade.jpg" },
  { name: "Todyl", demo: true, logo: "images/todyl.jpg" },
  { name: "ThreatDown", demo: true, logo: "images/threatdown.jpg" },
  { name: "Superops", demo: true, logo: "images/superops.jpg" },
  { name: "Sophos", demo: true, logo: "images/sophos.jpg" },
  { name: "SentinelOne", demo: true, logo: "images/sentinelone.jpg" },
  { name: "Redstor", demo: true, logo: "images/redstor.jpg" },
  { name: "Proofpoint", demo: true, logo: "images/proofpoint.jpg" },
  { name: "Printix", demo: true, logo: "images/printix.jpg" },
  { name: "Perimeter81", demo: true, logo: "images/perimeter81.jpg" },
  { name: "NordPass", demo: true, logo: "images/nordpass.jpg" },
  { name: "NordLayer", demo: true, logo: "images/nordlayer.jpg" },
  { name: "LastPass", demo: true, logo: "images/lastpass.jpg" },
  { name: "Keeper", demo: true, logo: "images/keeper.jpg" },
  { name: "Ironscales", demo: true, logo: "images/ironscales.jpg" },
  { name: "Exclaimer", demo: true, logo: "images/exclaimer.jpg" },
  { name: "Dropsuite", demo: true, logo: "images/dropsuite.jpg" },
  { name: "Domotz", demo: true, logo: "images/domotz.jpg" },
  { name: "DNSFilter", demo: true, logo: "images/dnsfilter.jpg" },
  { name: "Cynomi", demo: true, logo: "images/cynomi.jpg" },
  { name: "Crowdstrike", demo: true, logo: "images/crowdstrike.jpg" },
  { name: "Crewhu", demo: true, logo: "images/crewhu.jpg" },
  { name: "BlackPoint Cyber", demo: true, logo: "images/blackpoint-cyber.jpg" },
  { name: "Bitdefender", demo: true, logo: "images/bitdefender.jpg" },
  { name: "Axcient", demo: true, logo: "images/axcient.jpg" },
  { name: "CheckPoint", demo: true, logo: "images/checkpoint.jpg" },
  { name: "Auvik", demo: true, logo: "images/auvik.jpg" },
  { name: "Adobe", demo: true, logo: "images/adobe.jpg" },
  { name: "Addigy", demo: true, logo: "images/addigy.jpg" },
  { name: "Acronis", demo: true, logo: "images/acronis.jpg" }
      ];

    // Color palette (cyclic)
    const colors = [
      "#FF6B6B", "#FFD93D", "#6BCB77", "#4D96FF",
      "#FF8C42", "#9B5DE5", "#00BBF9", "#F15BB5",
      "#FFADAD", "#FEE440", "#8AC926", "#1982C4",
      "#80ED99", "#B8B8FF", "#FFC6FF", "#A0C4FF"
    ];
    // Distribute colors cyclically (no hint if demo or not)
    const products = rawProducts.map((p, i) => ({
      ...p,
      color: colors[i % colors.length]
    }));
// Preload das logos para evitar ‚Äúpiscadas‚Äù no primeiro spawn
function preloadLogos(list){
  list.forEach(p=>{
    if(p.logo){
      const img = new Image();
      img.src = p.logo;
    }
  });
}
preloadLogos(products);
    // Difficulty (includes scoring multiplier on hard)
    function getDifficultyParams() {
      const d = document.getElementById("difficulty").value;
      if (d === "easy")   return { duration: 5000, spawn: 1100, time: 60, scoreMult: 1.00 };
      if (d === "hard")   return { duration: 2600, spawn: 700,  time: 35, scoreMult: 1.50 };
      return               { duration: 3500, spawn: 900,  time: 45, scoreMult: 1.00 }; // normal
    }
    let DIFF = getDifficultyParams();

    // Game state
    let playerName = "";
    let score = 0;
    let timeLeft = DIFF.time;
    let gameInterval;
    let timerInterval;
    let ranking = []; // {name, points, last}
    let streak = 0;

    // Elements
    const startBtn = document.getElementById("startBtn");
    const scoreDisplay = document.getElementById("score");
    const timeDisplay = document.getElementById("time");
    const timeBar = document.getElementById("timeBar");
    const gameArea = document.getElementById("gameArea");
    const modalOverlay = document.getElementById("modalOverlay");
    const rankingList = document.getElementById("rankingList");
    const rankingListPersist = document.getElementById("rankingListPersist");
    const closeModal = document.getElementById("closeModal");
    const playAgainBtn = document.getElementById("playAgainBtn");
    const muteBtn = document.getElementById("muteBtn");
    const comboBadge = document.getElementById("comboBadge");

    // Intro elements
    const introOverlay   = document.getElementById("introOverlay");
    const introStartBtn  = document.getElementById("introStartBtn");
    const introDontShow  = document.getElementById("introDontShow");

    // Sound helpers
    let muted = false;
    function play(soundId) {
      if (muted) return;
      const el = document.getElementById(soundId);
      if (!el) return;
      el.currentTime = 0;
      el.volume = 0.25;
      el.play().catch(()=>{});
    }
    muteBtn.addEventListener("click", ()=>{
      muted = !muted;
      muteBtn.classList.toggle("muted", muted);
      muteBtn.textContent = muted ? "üîá Muted" : "üîä Sound";
    });
    document.addEventListener("keydown",(e)=>{
      if (e.key.toLowerCase()==="m") muteBtn.click();
    });

    // Persistence
    const LS_KEY = "se_pax8_game_ranking";
    function loadRanking() {
      try { const raw = localStorage.getItem(LS_KEY); return raw ? JSON.parse(raw) : []; }
      catch { return []; }
    }
    function saveRanking() {
      try { localStorage.setItem(LS_KEY, JSON.stringify(ranking)); }
      catch {}
    }

    // Load persisted ranking on boot
    ranking = loadRanking();
    renderRankingLists();

    // Show intro on first load unless user opted out
    (function showIntroOnLoad() {
      try {
        const hide = localStorage.getItem("se_pax8_game_hideIntro") === "1";
        if (!hide) introOverlay.style.display = "flex";
      } catch {
        introOverlay.style.display = "flex";
      }
    })();
    introStartBtn.addEventListener("click", () => {
      if (introDontShow.checked) {
        try { localStorage.setItem("se_pax8_game_hideIntro", "1"); } catch {}
      }
      introOverlay.style.display = "none";
    });
    document.addEventListener("keydown", (e) => {
      if (introOverlay.style.display === "flex" && e.key === "Escape") {
        introOverlay.style.display = "none";
      }
    });

    // Name capture
    document.getElementById("saveNameBtn").addEventListener("click", () => {
      playerName = document.getElementById("playerName").value.trim();
      if (playerName) {
        document.getElementById("playerForm").style.display = "none";
        document.getElementById("hud").style.display = "flex";
      } else {
        alert("Please type your name to play!");
      }
    });

    // Controls
    startBtn.addEventListener("click", startGame);
    closeModal.addEventListener("click", () => modalOverlay.style.display = "none");
    playAgainBtn.addEventListener("click", () => { modalOverlay.style.display = "none"; startGame(); });

    // Start round
    function startGame() {
      DIFF = getDifficultyParams();
      score = 0;
      streak = 0;
      updateComboBadge();
      timeLeft = DIFF.time;
      timeDisplay.textContent = timeLeft;
      timeBar.style.width = "100%";
      scoreDisplay.textContent = score;
      startBtn.disabled = true;
      gameArea.innerHTML = "";

      clearInterval(gameInterval);
      clearInterval(timerInterval);
      gameInterval = setInterval(spawnTarget, DIFF.spawn);
      timerInterval = setInterval(updateTimer, 1000);
    }

    // Timer
    function updateTimer() {
      timeLeft--;
      timeDisplay.textContent = timeLeft;
      const pct = Math.max(0, (timeLeft / DIFF.time) * 100);
      timeBar.style.width = pct + "%";
      if (timeLeft <= 0) endGame();
    }

    // Empty click penalty (-1)
    gameArea.addEventListener("click", (e) => {
      if (e.target !== gameArea) return; // clicked a target, ignore here
      score -= 1;
      scoreDisplay.textContent = score;
      play("sndMiss");
      showClickFx(e);
    });

    function showClickFx(e) {
      const rect = gameArea.getBoundingClientRect();
      const fx = document.createElement("div");
      fx.style.position = "absolute";
      fx.style.left = (e.clientX - rect.left) + "px";
      fx.style.top  = (e.clientY - rect.top)  + "px";
      fx.style.transform = "translate(-10px, -20px)";
      fx.style.pointerEvents = "none";
      fx.style.color = "#ff5252";
      fx.style.fontWeight = "bold";
      fx.style.textShadow = "0 1px 2px rgba(0,0,0,0.4)";
      fx.textContent = "-1";
      gameArea.appendChild(fx);
      setTimeout(()=>fx.remove(), 600);
    }
// Spawn targets (static) ‚Äî agora com logos
function spawnTarget() {
  const product = products[Math.floor(Math.random() * products.length)];
  const target = document.createElement("div");
  target.className = "target";
  // sem fundo/color no container

  // usa logo se existir; sen√£o cai pro texto
  if (product.logo) {
    target.innerHTML = `<img src="${product.logo}" alt="${product.name}" title="${product.name}">`;
    const imgEl = target.querySelector("img");
    imgEl.addEventListener("error", () => {
      target.textContent = product.name;
    }, { once: true });
  } else {
    target.textContent = product.name;
  }

  // posi√ß√£o aleat√≥ria considerando o tamanho da imagem (110px)
  const TARGET_SIZE = 110;
  target.style.left = Math.random() * (gameArea.clientWidth  - TARGET_SIZE) + "px";
  target.style.top  = Math.random() * (gameArea.clientHeight - TARGET_SIZE) + "px";

  // clique: pontua√ß√£o + combo/dificuldade
  target.addEventListener("click", (ev) => {
    const base = product.demo ? 10 : -5;
    if (product.demo) {
      streak++;
      play("sndHit");
    } else {
      streak = 0;
      play("sndMiss");
    }
    const combo = 1 + Math.floor(streak / 5) * 0.25;
    const mult  = product.demo ? (combo * DIFF.scoreMult) : 1;
    const points = Math.round(base * mult);

    score += points;
    scoreDisplay.textContent = score;
    flashPoints(target, points, product.demo, combo, DIFF.scoreMult);
    updateComboBadge(product.demo ? combo * DIFF.scoreMult : 1);

    target.remove();
    ev.stopPropagation(); // evita penalidade de clique vazio
  });

  gameArea.appendChild(target);
  setTimeout(() => target.remove(), DIFF.duration);
}
    function updateComboBadge(effCombo = 1) {
      const shown = Math.max(1, effCombo);
      comboBadge.textContent = `Streak: ${streak} | Combo: x${shown.toFixed(2)}`;
    }
    // Floating points feedback
    function flashPoints(target, points, isHit, combo, diffMult) {
      const fx = document.createElement("div");
      fx.style.position = "absolute";
      fx.style.left = target.style.left;
      fx.style.top  = target.style.top;
      fx.style.transform = "translate(12px,-12px)";
      fx.style.pointerEvents = "none";
      fx.style.color = isHit ? "#00e676" : "#ff5252";
      fx.style.fontWeight = "bold";
      fx.style.textShadow = "0 1px 2px rgba(0,0,0,0.4)";
      const extra = (isHit && (combo > 1 || diffMult > 1)) ? ` x${(combo*diffMult).toFixed(2)}` : "";
      fx.textContent = `${points > 0 ? "+" : ""}${points}${extra}`;
      gameArea.appendChild(fx);
      setTimeout(()=>fx.remove(), 800);
    }
    // End of round
    function endGame() {
      clearInterval(gameInterval);
      clearInterval(timerInterval);
      startBtn.disabled = false;
      // mark only current player as "last"
      ranking.forEach(r => r.last = false);
      ranking.push({ name: playerName, points: score, last: true });
      ranking.sort((a, b) => b.points - a.points);

      saveRanking();
      renderRankingLists();

      modalOverlay.style.display = "flex";
    }

    // Render both lists (modal + persistent)
    function renderRankingLists() {
      updateRanking(rankingList);
      updateRanking(rankingListPersist);
    }

    // Render a leaderboard <ol>
    function updateRanking(listEl) {
      listEl.innerHTML = "";
      ranking.forEach(r => {
        const li = document.createElement("li");
        li.textContent = `${r.name} - ${r.points} pts`;
        if (r.last) li.classList.add("highlight");
        listEl.appendChild(li);
      });
    }
  </script>
</body>
</html>












